(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8822:function(e,a,s){Promise.resolve().then(s.bind(s,5932))},5932:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return _}});var t=s(7437),l=s(2265),i=s(8420),c=s(1047),n=s(1128),r=s(5302),d=s(5131),o=s(2252),m=s(2369),x=s(5805);let u={PLAZA_MEDIA:m.Z,DOS_PLAZAS:x.Z,DOBLE:n.Z},h={PLAZA_MEDIA:"Plaza 1/2",DOS_PLAZAS:"2 Plazas",DOBLE:"Doble"},p={PLAZA_MEDIA:"bg-blue-100 text-blue-800 border-blue-300",DOS_PLAZAS:"bg-green-100 text-green-800 border-green-300",DOBLE:"bg-purple-100 text-purple-800 border-purple-300"};function g(e){let{rooms:a,onRoomClick:s,availabilityMode:l=!1}=e,i=e=>{if(l){let a=e.availableAt;return(e.reason,e.isAvailable)?!1===a?{status:"Ocupada",className:"room-occupied",color:"bg-red-500"}:{status:"Disponible",className:"room-available",color:"bg-green-500"}:{status:"Mantenimiento",className:"room-maintenance",color:"bg-yellow-500"}}return e.isAvailable?e.isOccupied?{status:"Ocupada",className:"room-occupied",color:"bg-red-500"}:{status:"Disponible",className:"room-available",color:"bg-green-500"}:{status:"Mantenimiento",className:"room-maintenance",color:"bg-yellow-500"}};return(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:a.map(e=>{let a=i(e),l=u[e.type];return(0,t.jsxs)("div",{onClick:()=>s(e),className:"card cursor-pointer transition-all duration-200 hover:shadow-lg hover:scale-105 ".concat(e.isAvailable&&!e.isOccupied?"hover:border-primary-300":""),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(l,{className:"h-5 w-5 text-gray-600 mr-2"}),(0,t.jsxs)("span",{className:"text-lg font-semibold text-gray-900",children:["Hab. ",e.number]})]}),(0,t.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(a.color)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"inline-block px-2 py-1 rounded-full text-xs font-medium border ".concat(p[e.type]),children:h[e.type]}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Precio:"}),(0,t.jsxs)("span",{className:"font-medium",children:["S/ ",e.price]})]})}),(0,t.jsx)("div",{className:"text-xs font-medium ".concat(a.className," px-2 py-1 rounded-full text-center"),children:a.status}),e.additionalInfo&&(0,t.jsxs)("div",{className:"text-xs text-gray-500 text-center mt-1",children:["occupied_until"===e.additionalInfo.type&&(0,t.jsxs)("span",{children:["Ocupada hasta ",e.additionalInfo.time]}),"available_until"===e.additionalInfo.type&&(0,t.jsxs)("span",{children:["Disponible hasta ",e.additionalInfo.time]})]})]})]},e.id)})})}var b=s(9501),j=s(3590),f=s(7119),N=s(2489),y=s(9064);let v=f.Ry({clientName:f.Z_().min(1,"El nombre es requerido"),clientDni:f.Z_().min(8,"El DNI debe tener al menos 8 caracteres"),clientOrigin:f.Z_().min(1,"La procedencia es requerida"),clientOccupation:f.Z_().optional(),roomId:f.Z_().min(1,"Debe seleccionar una habitaci\xf3n"),checkIn:f.Z_().min(1,"La fecha de check-in es requerida"),checkOut:f.Z_().min(1,"La fecha de check-out es requerida")});function w(e){let{rooms:a,selectedRoom:s,selectedDateTime:i,availabilityMode:n=!1,onClose:r,onSuccess:d}=e,[o,x]=(0,l.useState)(!1),[u,h]=(0,l.useState)(s||null),[p,g]=(0,l.useState)(""),[f,w]=(0,l.useState)(""),[S,D]=(0,l.useState)(!1),{register:k,handleSubmit:C,watch:A,setValue:Z,formState:{errors:O}}=(0,b.cI)({resolver:(0,j.F)(v),defaultValues:{roomId:(null==s?void 0:s.id)||"",checkIn:i||"",checkOut:""}}),E=A("checkIn"),I=A("roomId"),P=e=>{let a;if(!e)return"";let s=new Date(e),t=s.getHours(),l=(a=t>=0&&t<=5?new Date(s.getFullYear(),s.getMonth(),s.getDate(),12,59,0):new Date(s.getFullYear(),s.getMonth(),s.getDate()+1,12,59,0)).getFullYear(),i=String(a.getMonth()+1).padStart(2,"0"),c=String(a.getDate()).padStart(2,"0"),n=String(a.getHours()).padStart(2,"0"),r=String(a.getMinutes()).padStart(2,"0");return"".concat(l,"-").concat(i,"-").concat(c,"T").concat(n,":").concat(r)};(0,l.useEffect)(()=>{E&&Z("checkOut",P(E))},[E,Z]),(0,l.useEffect)(()=>{if(I&&!u){let e=a.find(e=>e.id===I);e&&h(e)}},[I,u,a]);let _=async()=>{if(I&&E){D(!0);try{let e=await fetch("".concat("http://localhost:5000","/api/rooms/").concat(I,"/availability/").concat(E)),a=await e.json();if(a.success){let e=new Date(a.data.suggestedCheckOut),s=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getDate()).padStart(2,"0"),i=String(e.getHours()).padStart(2,"0"),c=String(e.getMinutes()).padStart(2,"0"),n="".concat(s,"-").concat(t,"-").concat(l,"T").concat(i,":").concat(c);g(n),w(a.data.reason)}}catch(e){console.error("Error al obtener sugerencia:",e)}finally{D(!1)}}};(0,l.useEffect)(()=>{I&&E&&!p&&_()},[I,E,p]);let L=async e=>{x(!0);try{let a=await fetch("".concat("http://localhost:5000","/api/reservations"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await a.json();s.success?(y.ZP.success("Reserva creada exitosamente"),d()):y.ZP.error(s.error||"Error al crear la reserva")}catch(e){console.error("Error:",e),y.ZP.error("Error de conexi\xf3n")}finally{x(!1)}},M=n?a.filter(e=>e.isAvailable&&!0===e.availableAt):a.filter(e=>e.isAvailable&&!e.isOccupied);return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Nueva Reserva"}),(0,t.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,t.jsx)(N.Z,{className:"h-6 w-6"})})]}),(0,t.jsxs)("form",{onSubmit:C(L),className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[(0,t.jsx)(m.Z,{className:"h-5 w-5 mr-2"}),"Informaci\xf3n del Cliente"]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre *"}),(0,t.jsx)("input",{type:"text",...k("clientName"),className:"input-field",placeholder:"Nombre completo"}),O.clientName&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:O.clientName.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"DNI *"}),(0,t.jsx)("input",{type:"text",...k("clientDni"),className:"input-field",placeholder:"12345678"}),O.clientDni&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:O.clientDni.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Procedencia *"}),(0,t.jsx)("input",{type:"text",...k("clientOrigin"),className:"input-field",placeholder:"Ciudad de origen"}),O.clientOrigin&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:O.clientOrigin.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dedicaci\xf3n (Opcional)"}),(0,t.jsx)("input",{type:"text",...k("clientOccupation"),className:"input-field",placeholder:"Profesi\xf3n u ocupaci\xf3n"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[(0,t.jsx)(c.Z,{className:"h-5 w-5 mr-2"}),"Informaci\xf3n de la Reserva"]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Habitaci\xf3n *"}),(0,t.jsxs)("select",{...k("roomId"),className:"input-field",children:[(0,t.jsx)("option",{value:"",children:"Seleccionar habitaci\xf3n"}),M.map(e=>(0,t.jsxs)("option",{value:e.id,children:["Hab. ",e.number," - ","PLAZA_MEDIA"===e.type?"Plaza 1/2":"DOS_PLAZAS"===e.type?"2 Plazas":"Doble"," (S/ ",e.price,")"]},e.id))]}),O.roomId&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:O.roomId.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Check-in *"}),(0,t.jsx)("input",{type:"datetime-local",...k("checkIn"),className:"input-field",readOnly:n}),O.checkIn&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:O.checkIn.message}),n&&(0,t.jsx)("p",{className:"text-sm text-blue-600 mt-1",children:"Fecha seleccionada desde consulta de disponibilidad"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Check-out *"}),(0,t.jsx)("input",{type:"datetime-local",...k("checkOut",{required:!0}),className:"input-field"}),O.checkOut&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:O.checkOut.message})]}),p&&(0,t.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(c.Z,{className:"h-5 w-5 text-blue-600 mr-2"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-blue-900",children:"Check-out sugerido"}),(0,t.jsx)("p",{className:"text-sm text-blue-700",children:new Date(p).toLocaleString("es-PE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1})}),f&&(0,t.jsx)("p",{className:"text-xs text-blue-600 mt-1",children:f})]})]}),(0,t.jsx)("button",{type:"button",onClick:()=>{Z("checkOut",p,{shouldValidate:!0}),y.ZP.success("Check-out sugerido aplicado")},disabled:S,className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm font-medium transition-colors disabled:opacity-50",children:S?"Calculando...":"Aplicar"})]})}),u&&(0,t.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Habitaci\xf3n Seleccionada"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-600",children:"N\xfamero:"}),(0,t.jsxs)("span",{className:"font-medium ml-2",children:["Habitaci\xf3n ",u.number]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Tipo:"}),(0,t.jsx)("span",{className:"font-medium ml-2",children:"PLAZA_MEDIA"===u.type?"Plaza 1/2":"DOS_PLAZAS"===u.type?"2 Plazas":"Doble"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Precio por hora:"}),(0,t.jsxs)("span",{className:"font-medium ml-2",children:["S/ ",u.price]})]}),u.additionalInfo&&(0,t.jsxs)("div",{className:"col-span-2",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Disponibilidad:"}),(0,t.jsxs)("span",{className:"font-medium ml-2 text-blue-600",children:["available_until"===u.additionalInfo.type&&"Disponible hasta ".concat(u.additionalInfo.time),"occupied_until"===u.additionalInfo.type&&"Ocupada hasta ".concat(u.additionalInfo.time)]})]})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[(0,t.jsx)("button",{type:"button",onClick:r,className:"btn-secondary",disabled:o,children:"Cancelar"}),(0,t.jsx)("button",{type:"submit",className:"btn-primary",disabled:o,children:o?"Creando...":"Crear Reserva"})]})]})]})})}var S=s(8226),D=s(3774),k=s(5005),C=s(1723),A=s(3639);function Z(e){var a,s,i,n;let{isOpen:r,onClose:d,room:o,reservation:x,onCancelReservation:u}=e,[h,p]=(0,l.useState)(!1),[g,b]=(0,l.useState)(!1);if(!r||!o||!x)return null;let j=async()=>{p(!0);try{await u(x.id),d()}catch(e){console.error("Error al cancelar reserva:",e)}finally{p(!1),b(!1)}},f=e=>new Date(e).toLocaleDateString("es-PE",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4 max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-gray-800",children:["Detalles de Reserva - Habitaci\xf3n ",o.number]}),(0,t.jsx)("button",{onClick:d,className:"text-gray-500 hover:text-gray-700 transition-colors",children:(0,t.jsx)(N.Z,{size:24})})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-700 mb-2",children:"Habitaci\xf3n"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"N\xfamero:"}),(0,t.jsx)("span",{className:"font-medium",children:o.number})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Tipo:"}),(0,t.jsx)("span",{className:"font-medium",children:(e=>{switch(e){case"PLAZA_MEDIA":return"Plaza 1/2";case"DOS_PLAZAS":return"2 Plazas";case"DOBLE":return"Doble";default:return e}})(o.type)})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(S.Z,{size:16,className:"text-gray-500"}),(0,t.jsx)("span",{className:"text-gray-600",children:"Precio:"}),(0,t.jsxs)("span",{className:"font-medium",children:["S/ ",o.price]})]})]})]}),(0,t.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,t.jsxs)("h3",{className:"font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[(0,t.jsx)(m.Z,{size:16}),"Cliente"]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Nombre:"}),(0,t.jsx)("span",{className:"font-medium",children:null===(a=x.client)||void 0===a?void 0:a.name})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"DNI:"}),(0,t.jsx)("span",{className:"font-medium",children:null===(s=x.client)||void 0===s?void 0:s.dni})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(D.Z,{size:16,className:"text-gray-500"}),(0,t.jsx)("span",{className:"text-gray-600",children:"Origen:"}),(0,t.jsx)("span",{className:"font-medium",children:null===(i=x.client)||void 0===i?void 0:i.origin})]}),(null===(n=x.client)||void 0===n?void 0:n.occupation)&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(k.Z,{size:16,className:"text-gray-500"}),(0,t.jsx)("span",{className:"text-gray-600",children:"Ocupaci\xf3n:"}),(0,t.jsx)("span",{className:"font-medium",children:x.client.occupation})]})]})]}),(0,t.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,t.jsxs)("h3",{className:"font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[(0,t.jsx)(c.Z,{size:16}),"Reserva"]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(C.Z,{size:16,className:"text-gray-500"}),(0,t.jsx)("span",{className:"text-gray-600",children:"Check-in:"}),(0,t.jsx)("span",{className:"font-medium",children:f(x.checkIn)})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(C.Z,{size:16,className:"text-gray-500"}),(0,t.jsx)("span",{className:"text-gray-600",children:"Check-out:"}),(0,t.jsx)("span",{className:"font-medium",children:f(x.checkOut)})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(S.Z,{size:16,className:"text-gray-500"}),(0,t.jsx)("span",{className:"text-gray-600",children:"Total:"}),(0,t.jsxs)("span",{className:"font-medium",children:["S/ ",x.totalPrice]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Estado:"}),(0,t.jsx)("span",{className:"font-medium px-2 py-1 rounded text-sm ".concat("ACTIVE"===x.status?"bg-green-100 text-green-800":"COMPLETED"===x.status?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"),children:"ACTIVE"===x.status?"Activa":"COMPLETED"===x.status?"Completada":"Cancelada"})]})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)("button",{onClick:d,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cerrar"}),"ACTIVE"===x.status&&(0,t.jsxs)("button",{onClick:()=>b(!0),className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center justify-center gap-2",disabled:h,children:[(0,t.jsx)(A.Z,{size:16}),"Cancelar Reserva"]})]})]}),g&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-60",children:(0,t.jsx)("div",{className:"bg-white rounded-lg p-6 w-full max-w-sm mx-4",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(A.Z,{size:48,className:"mx-auto text-red-500 mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"\xbfConfirmar Cancelaci\xf3n?"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:"Esta acci\xf3n no se puede deshacer. La reserva ser\xe1 cancelada permanentemente."}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:()=>b(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",disabled:h,children:"No, Mantener"}),(0,t.jsx)("button",{onClick:j,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",disabled:h,children:h?"Cancelando...":"S\xed, Cancelar"})]})]})})})]})})}var O=s(9076);function E(e){let{selectedDateTime:a,onDateTimeChange:s,onReset:i}=e,[n,r]=(0,l.useState)(!1),[d,o]=(0,l.useState)(""),m=e=>{let a=new Date(new Date().getTime()+36e5*e),t=a.getFullYear(),l=String(a.getMonth()+1).padStart(2,"0"),i=String(a.getDate()).padStart(2,"0"),c=String(a.getHours()).padStart(2,"0"),n=String(a.getMinutes()).padStart(2,"0");s("".concat(t,"-").concat(l,"-").concat(i,"T").concat(c,":").concat(n)),r(!1),o("")},x=()=>{let e=new Date,a=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),t=String(e.getDate()).padStart(2,"0"),l=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0");return"".concat(a,"-").concat(s,"-").concat(t,"T").concat(l,":").concat(i)};return(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[(0,t.jsx)(c.Z,{className:"h-5 w-5 mr-2"}),"Consultar Disponibilidad"]}),(0,t.jsxs)("button",{onClick:i,className:"text-sm text-gray-500 hover:text-gray-700 transition-colors flex items-center",children:[(0,t.jsx)(O.Z,{className:"h-4 w-4 mr-1"}),"Ver actual"]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[(0,t.jsx)("button",{onClick:()=>m(0),className:"px-3 py-2 text-sm bg-blue-50 text-blue-700 rounded-md hover:bg-blue-100 transition-colors",children:"Ahora"}),(0,t.jsxs)("button",{onClick:()=>{r(!n),setTimeout(()=>{let e=document.querySelector('input[type="datetime-local"]');if(e){var a;e.focus(),null===(a=e.showPicker)||void 0===a||a.call(e)}},100)},className:"px-3 py-2 text-sm bg-gray-50 text-gray-700 rounded-md hover:bg-gray-100 transition-colors flex items-center justify-center",children:[(0,t.jsx)(C.Z,{className:"h-4 w-4 mr-1"}),"Personalizar"]})]}),n&&(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha y Hora Espec\xedfica"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"datetime-local",value:d||x(),onChange:e=>o(e.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:x()}),(0,t.jsx)("button",{onClick:()=>{d&&(s(d),r(!1))},disabled:!d,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:"Buscar"})]})]}),a&&(0,t.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3",children:[(0,t.jsx)("p",{className:"text-sm text-blue-800",children:(0,t.jsx)("strong",{children:"Consultando disponibilidad para:"})}),(0,t.jsx)("p",{className:"text-blue-900 font-medium",children:(e=>{if(!e)return"Seleccionar fecha";let a=new Date(e),s=new Date,t=a.toDateString()===s.toDateString(),l=a.toLocaleDateString("es-PE",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),i=a.toLocaleTimeString("es-PE",{hour:"2-digit",minute:"2-digit"});return"".concat(t?"Hoy":l," a las ").concat(i)})(a)})]})]})}let I={blue:"bg-blue-500",red:"bg-red-500",green:"bg-green-500",yellow:"bg-yellow-500"};function P(e){let{title:a,value:s,icon:l,color:i}=e;return(0,t.jsx)("div",{className:"card",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"p-3 rounded-lg ".concat(I[i]," bg-opacity-10"),children:(0,t.jsx)(l,{className:"h-6 w-6 ".concat(I[i].replace("bg-","text-"))})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:a}),(0,t.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:s})]})]})})}function _(){let[e,a]=(0,l.useState)([]),[s,m]=(0,l.useState)([]),[x,u]=(0,l.useState)({total:0,occupied:0,available:0,occupancyRate:0}),[h,p]=(0,l.useState)(!0),[b,j]=(0,l.useState)(!1),[f,N]=(0,l.useState)(null),[y,v]=(0,l.useState)(!1),[S,D]=(0,l.useState)(null),[k,C]=(0,l.useState)(""),[A,O]=(0,l.useState)(!1);(0,l.useEffect)(()=>{I()},[]);let I=async()=>{try{let[e,s,t]=await Promise.all([fetch("".concat("http://localhost:5000","/api/rooms")),fetch("".concat("http://localhost:5000","/api/reservations")),fetch("".concat("http://localhost:5000","/api/rooms/stats/overview"))]),l=await e.json(),i=await s.json(),c=await t.json();l.success&&a(l.data),i.success&&m(i.data),c.success&&u(c.data)}catch(e){console.error("Error fetching data:",e)}finally{p(!1)}},_=async e=>{try{p(!0);let s=await fetch("".concat("http://localhost:5000","/api/rooms/available/date/").concat(encodeURIComponent(e))),t=await s.json();if(t.success){a(t.data),O(!0);let e=t.data.length,s=t.data.filter(e=>!1===e.availableAt).length,l=t.data.filter(e=>!0===e.availableAt&&e.isAvailable).length;u({total:e,occupied:s,available:l,occupancyRate:e>0?Math.round(s/e*1e3)/10:0})}}catch(e){console.error("Error fetching availability:",e)}finally{p(!1)}},L=async e=>{try{let a=await fetch("".concat("http://localhost:5000","/api/reservations/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"CANCELLED"})}),s=await a.json();if(s.success)A&&k?await _(k):await I(),v(!1),D(null);else throw Error(s.error||"Error al cancelar la reserva")}catch(e){throw console.error("Error al cancelar reserva:",e),e}};return h?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(i.Z,{className:"h-8 w-8 text-primary-600 mr-3"}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Sistema de Gesti\xf3n Hotelera"})]}),(0,t.jsxs)("button",{onClick:()=>{N(null),j(!0)},className:"btn-primary flex items-center",children:[(0,t.jsx)(c.Z,{className:"h-5 w-5 mr-2"}),"Nueva Reserva"]})]})})}),(0,t.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,t.jsx)(P,{title:"Total Habitaciones",value:x.total,icon:n.Z,color:"blue"}),(0,t.jsx)(P,{title:"Ocupadas",value:x.occupied,icon:r.Z,color:"red"}),(0,t.jsx)(P,{title:"Disponibles",value:x.available,icon:d.Z,color:"green"}),(0,t.jsx)(P,{title:"Ocupaci\xf3n",value:"".concat(x.occupancyRate,"%"),icon:o.Z,color:"yellow"})]}),(0,t.jsx)(E,{selectedDateTime:k,onDateTimeChange:e=>{C(e),e&&_(e)},onReset:()=>{C(""),O(!1),I()}}),(0,t.jsxs)("div",{className:"card",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:A?"Disponibilidad para Fecha Seleccionada":"Estado de Habitaciones"}),(0,t.jsxs)("div",{className:"flex items-center space-x-4 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full mr-2"}),(0,t.jsx)("span",{children:"Disponible"})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full mr-2"}),(0,t.jsx)("span",{children:"Ocupada"})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-yellow-500 rounded-full mr-2"}),(0,t.jsx)("span",{children:"Mantenimiento"})]})]})]}),(0,t.jsx)(g,{rooms:e,availabilityMode:A,onRoomClick:e=>{if(A){let a=e.availableAt;!1===a?(D(e),v(!0)):a&&e.isAvailable&&(N(e),j(!0))}else e.isOccupied?(D(e),v(!0)):e.isAvailable&&(N(e),j(!0))}})]})]}),b&&(0,t.jsx)(w,{rooms:e,selectedRoom:f,selectedDateTime:k,availabilityMode:A,onClose:()=>{j(!1),N(null)},onSuccess:()=>{j(!1),N(null),A&&k?_(k):I()}}),y&&S&&(0,t.jsx)(Z,{isOpen:y,room:S,reservation:(e=>{var a,s;if(!A||!k)return(null===(s=e.reservations)||void 0===s?void 0:s.find(e=>"ACTIVE"===e.status))||null;{let s=new Date(k);return(null===(a=e.reservations)||void 0===a?void 0:a.find(e=>{if("ACTIVE"!==e.status)return!1;let a=new Date(e.checkIn),t=new Date(e.checkOut);return s>=a&&s<=t}))||null}})(S),onClose:()=>{v(!1),D(null)},onCancelReservation:L})]})}}},function(e){e.O(0,[64,623,971,117,744],function(){return e(e.s=8822)}),_N_E=e.O()}]);